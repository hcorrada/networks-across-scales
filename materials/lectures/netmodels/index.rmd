---
title: "Random Networks"
author: "Héctor Corrada Bravo"
company: "University of Maryland"
date: "`r Sys.Date()`"
css: ["custom.css"]
output: 
  xaringan::moon_reader:
    lib_dir: libs
    seal: false
    includes:
      after_body: "custom.html"
    nature:
      ratio: "16:9"
---

class: title-slide, center, middle
count: false

.banner[![](img/head.png)]

.title[Random Networks]

.author[Héctor Corrada Bravo]

.other-info[
University of Maryland, College Park, USA  
CMSC828O `r Sys.Date()`
]

.logo[![](img/logo.png)]

---
class: split-50
exclude: true

## What does my group do?

.column[
Study the **molecular** basis of *variation* in development and disease


Using **high-throughput** experimental methods  
]

.column[.image-80[![](img/stickmen.png)]]

---

## The core of data analysis

Given observations (entities), and their characteristics (attributes)

Understand how those characteristics are _distributed_ in the population

- means, variances, empirical distributions
- data generative models with parameters

Hope we can infer something useful about that population from the understanding of the distribution of characteristics

---

## Thinking of networks in terms of data analysis

One way of thinking about networks:

- Entities and their characteristics (nodes and their attributes)
- Interactions and their characteristics (edges and their attributes)

How is the _presence or absence of interactions_ distributed in the population?

---

## Presence/absence models

Consider the analysis of a binary attribute in the population.

E.g., is gene PTEN expressed in normal breast cells?

What is a model we tend to use? Suppose the gene is expressed in $p$ cells in the
population.

I take a sample of $N$ cells, measure how many express PTEN.

---

## Presence/absence models

If we do this sampling experiment many times, we expect to see Binomial distribution

$$Y \sim Bin(N,p)$$

```{r, echo=FALSE, fig.align="center", fig.height=4.5}
hist(rbinom(1000, 100, .2), xlab="Y", main="Bin(100,.2)")
```

---

## Presence/absence models

What is our expectation for $Y$?
Variance?

--

For very large $N$, same distribution is well approximated by $Y\sim\mathrm{Poisson}(\lambda=pN)$

---

## Presence/absence models

```{r, echo=FALSE, fig.align="center"}
hist(rpois(1000, 1000*.2), xlab="Y",main="Pois(1000*.2)")
```

---

## Presence/absence models

We can follow a similar idea to model presence/absence of an _interaction_ in the network

Given a network over $N$ entities (vertices)

What is the population of interest? All possible pairwise interactions

---

## Presence/absence models

Assumptions:

Fraction $p$ of interactions actually occur in the population

The observed edges is a _realization_ of random occurrences in measurement of those interactions

How can we model the number of edges in a network?

---

## Presence/absence models

$Y \sim Bin(N(N-1/2), p)$

```{r, echo=FALSE, fig.align="center", fig.height=5}
hist(rbinom(1000, 100*99/2, .2), main="Bin(100*99/2, .2)", xlab="Y")
```

---

## Presence/absence models

What if we ask this question _one node at a time_?

If proportion $p$ of interactions actually occur in the population, then 
what is the distribution of the number of interactions (edges) for a single node?

---

## Presence/absence models

$k_i \sim Bin(N-1,p)$

```{r, echo=FALSE, fig.align="center", fig.height=5}
hist(rbinom(100, 99, .2), main="Bin(99,.2)", xlab="Y")
```

---

## Important observations

Expected degree is $p(N-1)$. 

--

One reasonable estimate from data would be $<k>$ (average degree)

---
class: split-50

## Important observations

.column[
- Degrees concentrated around expectation
- Low degree and high degree nodes rare
]
.column[
```{r, echo=FALSE, fig.align="center", fig.height=4}
hist(rbinom(1000, 99, .2), main="Bin(99,.2)", xlab="Y")
```
]

---

## Important observations

Back to Poisson

$k_i \sim \mathrm{Pois(<k>)}$

$p_k=P(k_i=k)=e^{-<k>}\frac{<k>}{k!}$

---

## Important observations

.center[![](img/pois.png)]

---

## ER network model

_Erdos-Renyi_ Construct a network with $N$ vertices given parameter $p$ by connecting vertices with probability $p$

---

## ER model

Emmergence of connected component

.center[![](img/er.png)]


---

## ER model

Small world

.center[![](img/smallworld.png)]

---

## ER model

Clustering coefficient?

On the board

---

## ER model

How well does this model fit data?

.image-40.center[![](img/plot_loglog-1.png)]

---

## ER model

How well does this model fit data?

.center[![](img/erfit.png)]

---

## Power law

We see that exponential decay of high-degree probability does not fit data well.

Log-log plot suggests a linear relationship

$\log p_k \approx -\gamma \times \log k$

$p_k \approx k^{-\gamma}$

---

## Power law

.image-50[.center[![](img/power1.png)]]

---

## Power law

.center[![](img/power2.png)]

---

## Power law (ultra-small world)

.image-50[.center[![](img/ultrasmall.png)]]

---

## Power law (scale-free)

.image-70[.center[![](img/scalefree.png)]]

---

## Power Law

Generative random model for ER (poisson, random) network was straightforward

Next topics:
- Why scale-free?
- Fitting power law networks to data
- Generative random model for power law networks
- More sophisticated models to fit empirical data closer
- Biologically-plausible random models (evolution/fitness etc.)



